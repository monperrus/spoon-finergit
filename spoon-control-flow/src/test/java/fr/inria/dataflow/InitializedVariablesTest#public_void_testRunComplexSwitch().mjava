@Test
public
void
testRunComplexSwitch
(
)
throws
Exception
{
ControlFlowGraph
graph
=
ForwardFlowBuilderVisitorTest
.
buildGraph
(
this
.
getClass
(
)
.
getResource
(
"/initialized"
)
.
toURI
(
)
.
getPath
(
)
,
"realForwardFull"
,
true
)
;
System
.
out
.
println
(
"Compiled OK"
)
;
InitializedVariables
vars
=
new
InitializedVariables
(
)
;
graph
.
simplify
(
)
;
System
.
out
.
print
(
graph
.
toGraphVisText
(
)
)
;
ControlFlowNode
n
=
ControlFlowBuilder
.
firstNode
(
graph
,
graph
.
branches
(
)
.
get
(
3
)
.
getStatement
(
)
.
getParent
(
)
)
;
vars
.
run
(
n
)
;
HashSet
<
String
>
names
=
new
HashSet
<
>
(
)
;
for
(
CtVariableReference
v
:
vars
.
getInitialized
(
)
)
names
.
add
(
v
.
getSimpleName
(
)
)
;
assertEquals
(
vars
.
getInitialized
(
)
.
size
(
)
,
6
)
;
assertTrue
(
names
.
contains
(
"a"
)
)
;
assertTrue
(
names
.
contains
(
"twon"
)
)
;
assertTrue
(
names
.
contains
(
"offa"
)
)
;
assertTrue
(
names
.
contains
(
"m"
)
)
;
assertTrue
(
names
.
contains
(
"plan"
)
)
;
assertTrue
(
names
.
contains
(
"n"
)
)
;
}
