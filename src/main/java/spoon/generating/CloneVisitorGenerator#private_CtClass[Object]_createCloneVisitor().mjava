private
CtClass
<
Object
>
createCloneVisitor
(
)
{
final
CtPackage
aPackage
=
getFactory
(
)
.
Package
(
)
.
getOrCreate
(
TARGET_CLONE_PACKAGE
)
;
final
CtClass
<
Object
>
target
=
getFactory
(
)
.
Class
(
)
.
get
(
GENERATING_CLONE
)
;
target
.
setSimpleName
(
TARGET_CLONE_TYPE
)
;
target
.
addModifier
(
ModifierKind
.
PUBLIC
)
;
aPackage
.
addType
(
target
)
;
final
List
<
CtTypeReference
>
references
=
target
.
getReferences
(
new
ReferenceFilter
<
CtTypeReference
>
(
)
{
@Override
public
boolean
matches
(
CtTypeReference
reference
)
{
return
reference
!=
null
&&
GENERATING_CLONE
.
equals
(
reference
.
getQualifiedName
(
)
)
;
}
@Override
public
Class
<
CtTypeReference
>
getType
(
)
{
return
CtTypeReference
.
class
;
}
}
)
;
for
(
CtTypeReference
reference
:
references
)
{
reference
.
setSimpleName
(
TARGET_CLONE_TYPE
)
;
reference
.
setPackage
(
aPackage
.
getReference
(
)
)
;
}
return
target
;
}
