/** 
 * Creates a one-dimension array that must only contain literals.
 */
@SuppressWarnings("unchecked")
public
<
T
>
CtNewArray
<
T
[
]
>
createLiteralArray
(
T
[
]
value
)
{
if
(
!
value
.
getClass
(
)
.
isArray
(
)
)
{
throw
new
RuntimeException
(
"value is not an array"
)
;
}
if
(
value
.
getClass
(
)
.
getComponentType
(
)
.
isArray
(
)
)
{
throw
new
RuntimeException
(
"can only create one-dimension arrays"
)
;
}
final
CtTypeReference
<
T
>
componentTypeRef
=
factory
.
Type
(
)
.
createReference
(
(
Class
<
T
>
)
value
.
getClass
(
)
.
getComponentType
(
)
)
;
final
CtArrayTypeReference
<
T
[
]
>
arrayReference
=
factory
.
Type
(
)
.
createArrayReference
(
componentTypeRef
)
;
CtNewArray
<
T
[
]
>
array
=
factory
.
Core
(
)
.
createNewArray
(
)
.
setType
(
arrayReference
)
;
for
(
T
e
:
value
)
{
CtLiteral
<
T
>
l
=
factory
.
Core
(
)
.
createLiteral
(
)
;
l
.
setValue
(
e
)
;
array
.
addElement
(
l
)
;
}
return
array
;
}
