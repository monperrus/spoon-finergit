@Override
@SuppressWarnings("rawtypes")
public
<
T
>
void
visitCtNewArray
(
CtNewArray
<
T
>
newArray
)
{
enterCtExpression
(
newArray
)
;
boolean
isNotInAnnotation
;
try
{
isNotInAnnotation
=
(
newArray
.
getParent
(
CtAnnotationType
.
class
)
==
null
)
&&
(
newArray
.
getParent
(
CtAnnotation
.
class
)
==
null
)
;
}
catch
(
ParentNotInitializedException
e
)
{
isNotInAnnotation
=
true
;
}
if
(
isNotInAnnotation
)
{
CtTypeReference
<
?
>
ref
=
newArray
.
getType
(
)
;
if
(
ref
!=
null
)
{
printer
.
write
(
"new "
)
;
}
context
.
skipArray
=
true
;
scan
(
ref
)
;
context
.
skipArray
=
false
;
for
(
int
i
=
0
;
ref
instanceof
CtArrayTypeReference
;
i
++
)
{
printer
.
write
(
"["
)
;
if
(
newArray
.
getDimensionExpressions
(
)
.
size
(
)
>
i
)
{
CtExpression
<
Integer
>
e
=
newArray
.
getDimensionExpressions
(
)
.
get
(
i
)
;
if
(
!
(
e
instanceof
CtStatement
)
)
{
elementPrinterHelper
.
writeComment
(
e
,
CommentOffset
.
BEFORE
)
;
}
scan
(
e
)
;
if
(
!
(
e
instanceof
CtStatement
)
)
{
elementPrinterHelper
.
writeComment
(
e
,
CommentOffset
.
AFTER
)
;
}
}
printer
.
write
(
"]"
)
;
ref
=
(
(
CtArrayTypeReference
)
ref
)
.
getComponentType
(
)
;
}
}
if
(
newArray
.
getDimensionExpressions
(
)
.
size
(
)
==
0
)
{
printer
.
write
(
"{ "
)
;
for
(
CtExpression
e
:
newArray
.
getElements
(
)
)
{
if
(
!
(
e
instanceof
CtStatement
)
)
{
elementPrinterHelper
.
writeComment
(
e
,
CommentOffset
.
BEFORE
)
;
}
scan
(
e
)
;
printer
.
write
(
" , "
)
;
if
(
!
(
e
instanceof
CtStatement
)
)
{
elementPrinterHelper
.
writeComment
(
e
,
CommentOffset
.
AFTER
)
;
}
}
if
(
newArray
.
getElements
(
)
.
size
(
)
>
0
)
{
printer
.
removeLastChar
(
)
;
}
printer
.
write
(
" }"
)
;
}
exitCtExpression
(
newArray
)
;
}
