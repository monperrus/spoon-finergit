@SuppressWarnings("unchecked")
@Override
public
boolean
visit
(
MethodDeclaration
methodDeclaration
,
ClassScope
scope
)
{
CtMethod
<
?
>
m
=
factory
.
Core
(
)
.
createMethod
(
)
;
m
.
setSimpleName
(
new
String
(
methodDeclaration
.
selector
)
)
;
m
.
setType
(
references
.
getTypeReference
(
methodDeclaration
.
returnType
.
resolvedType
)
)
;
m
.
setModifiers
(
getModifiers
(
methodDeclaration
.
modifiers
)
)
;
if
(
methodDeclaration
.
thrownExceptions
!=
null
)
{
for
(
TypeReference
r
:
methodDeclaration
.
thrownExceptions
)
m
.
getThrownTypes
(
)
.
add
(
references
.
getTypeReference
(
r
.
resolvedType
)
)
;
}
if
(
methodDeclaration
.
binding
!=
null
)
{
for
(
TypeBinding
b
:
methodDeclaration
.
binding
.
typeVariables
)
{
m
.
getFormalTypeParameters
(
)
.
add
(
references
.
getBoundedTypeReference
(
b
)
)
;
}
}
if
(
scope
!=
null
)
{
m
.
setDocComment
(
getJavaDoc
(
methodDeclaration
.
javadoc
,
scope
.
referenceCompilationUnit
(
)
)
)
;
}
else
if
(
methodDeclaration
.
scope
!=
null
)
{
m
.
setDocComment
(
getJavaDoc
(
methodDeclaration
.
javadoc
,
methodDeclaration
.
scope
.
referenceCompilationUnit
(
)
)
)
;
}
else
{
logger
.
error
(
"null scope"
,
new
Exception
(
)
)
;
}
context
.
enter
(
m
,
methodDeclaration
)
;
if
(
methodDeclaration
.
annotations
!=
null
)
for
(
Annotation
a
:
methodDeclaration
.
annotations
)
a
.
traverse
(
this
,
methodDeclaration
.
scope
)
;
if
(
methodDeclaration
.
arguments
!=
null
)
for
(
Argument
a
:
methodDeclaration
.
arguments
)
a
.
traverse
(
this
,
methodDeclaration
.
scope
)
;
if
(
!
methodDeclaration
.
isAbstract
(
)
&&
(
methodDeclaration
.
modifiers
&
ClassFileConstants
.
AccNative
)
==
0
)
{
CtBlock
<
?
>
b
=
factory
.
Core
(
)
.
createBlock
(
)
;
context
.
enter
(
b
,
methodDeclaration
)
;
}
if
(
methodDeclaration
.
statements
!=
null
)
{
for
(
Statement
s
:
methodDeclaration
.
statements
)
s
.
traverse
(
this
,
methodDeclaration
.
scope
)
;
}
return
false
;
}
