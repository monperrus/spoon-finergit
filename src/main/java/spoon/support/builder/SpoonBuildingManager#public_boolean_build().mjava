public
boolean
build
(
)
throws
Exception
{
if
(
factory
==
null
)
{
throw
new
Exception
(
"Factory not initialized"
)
;
}
if
(
build
)
{
throw
new
Exception
(
"Model already built"
)
;
}
build
=
true
;
boolean
srcSuccess
,
templateSuccess
;
factory
.
getEnvironment
(
)
.
debugMessage
(
"compiling sources: "
+
sources
.
getAllJavaFiles
(
)
)
;
long
t
=
System
.
currentTimeMillis
(
)
;
compiler
=
new
SpoonCompiler
(
)
;
compiler
.
javaCompliance
=
factory
.
getEnvironment
(
)
.
getComplianceLevel
(
)
;
compiler
.
setClasspath
(
factory
.
getEnvironment
(
)
.
getClasspath
(
)
)
;
initCompiler
(
)
;
srcSuccess
=
compiler
.
compileSrc
(
factory
,
sources
.
getAllJavaFiles
(
)
)
;
reportProblems
(
)
;
factory
.
getEnvironment
(
)
.
debugMessage
(
"compiled in "
+
(
System
.
currentTimeMillis
(
)
-
t
)
+
" ms"
)
;
factory
.
getEnvironment
(
)
.
debugMessage
(
"compiling templates: "
+
templates
.
getAllJavaFiles
(
)
)
;
t
=
System
.
currentTimeMillis
(
)
;
templateSuccess
=
compiler
.
compileTemplate
(
factory
,
templates
.
getAllJavaFiles
(
)
)
;
factory
.
Template
(
)
.
parseTypes
(
)
;
factory
.
getEnvironment
(
)
.
debugMessage
(
"compiled in "
+
(
System
.
currentTimeMillis
(
)
-
t
)
+
" ms"
)
;
return
srcSuccess
&&
templateSuccess
;
}
