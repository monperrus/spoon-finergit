private
static
CtStatement
internalCompileStatement
(
CtElement
st
,
CtTypeReference
returnType
)
{
Factory
f
=
st
.
getFactory
(
)
;
CtClass
<
?
>
w
=
createWrapper
(
st
,
f
,
returnType
)
;
build
(
f
,
w
)
;
CtType
<
?
>
c
=
f
.
Type
(
)
.
get
(
WRAPPER_CLASS_NAME
)
;
CtMethod
<
?
>
wrapper
=
c
.
getMethod
(
WRAPPER_METHOD_NAME
)
;
List
<
CtStatement
>
statements
=
wrapper
.
getBody
(
)
.
getStatements
(
)
;
CtStatement
ret
=
statements
.
get
(
statements
.
size
(
)
-
1
)
;
c
.
getPackage
(
)
.
getTypes
(
)
.
remove
(
c
)
;
if
(
ret
instanceof
CtClass
)
{
CtClass
klass
=
(
CtClass
)
ret
;
klass
.
setSimpleName
(
klass
.
getSimpleName
(
)
.
replaceAll
(
"^[0-9]*"
,
""
)
)
;
klass
.
setParent
(
ret
.
getFactory
(
)
.
Package
(
)
.
getRootPackage
(
)
)
;
ret
.
getFactory
(
)
.
Package
(
)
.
getRootPackage
(
)
.
addType
(
klass
)
;
}
return
ret
;
}
