protected
<
T
>
CtLocalVariable
<
T
>
getLocalVariableDeclaration
(
final
String
name
)
{
List
<
CtElement
>
reversedElements
=
new
ArrayList
<
CtElement
>
(
context
.
stack
.
size
(
)
)
;
for
(
ASTPair
element
:
context
.
stack
)
{
reversedElements
.
add
(
0
,
element
.
element
)
;
}
for
(
CtElement
element
:
reversedElements
)
{
EarlyTerminatingScanner
<
CtLocalVariable
<
?
>
>
scanner
=
new
EarlyTerminatingScanner
<
CtLocalVariable
<
?
>
>
(
)
{
@Override
public
<
T
>
void
visitCtLocalVariable
(
CtLocalVariable
<
T
>
localVariable
)
{
if
(
name
.
equals
(
localVariable
.
getSimpleName
(
)
)
)
{
setResult
(
localVariable
)
;
terminate
(
)
;
return
;
}
super
.
visitCtLocalVariable
(
localVariable
)
;
}
}
;
element
.
accept
(
scanner
)
;
CtLocalVariable
<
T
>
var
=
(
CtLocalVariable
<
T
>
)
scanner
.
getResult
(
)
;
if
(
var
!=
null
)
{
return
var
;
}
}
LOGGER
.
error
(
"could not find declaration for local variable "
+
name
+
" at "
+
context
.
stack
.
peek
(
)
.
element
.
getPosition
(
)
)
;
return
null
;
}
