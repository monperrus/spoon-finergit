/** 
 * Returns the runtime object corresponding to the expression eg CtLiteral(3) -> 3
 */
public
static
Object
getCorrespondingRuntimeObject
(
CtExpression
<
?
>
value
)
{
if
(
value
instanceof
CtNewArray
)
{
return
toArray
(
(
CtNewArray
)
value
)
;
}
else
if
(
value
instanceof
CtAnnotation
)
{
return
(
(
CtAnnotation
<
?
>
)
value
)
.
getActualAnnotation
(
)
;
}
else
if
(
value
instanceof
CtLiteral
)
{
return
(
(
CtLiteral
<
?
>
)
value
)
.
getValue
(
)
;
}
else
if
(
value
instanceof
CtFieldRead
)
{
try
{
CtFieldReference
<
?
>
fieldRef
=
(
(
CtFieldRead
<
?
>
)
value
)
.
getVariable
(
)
;
Class
<
?
>
c
=
fieldRef
.
getDeclaringType
(
)
.
getActualClass
(
)
;
CtField
<
?
>
field
=
fieldRef
.
getDeclaration
(
)
;
if
(
Enum
.
class
.
isAssignableFrom
(
c
)
)
{
return
Enum
.
valueOf
(
(
Class
<
?
Enum
>
)
c
,
fieldRef
.
getSimpleName
(
)
)
;
}
}
catch
(
Exception
e
)
{
throw
new
SpoonException
(
"cannot get runtime enum value"
,
e
)
;
}
}
throw
new
SpoonException
(
"not possible to transform to runtime object "
+
value
+
" "
+
value
.
getClass
(
)
.
getName
(
)
)
;
}
