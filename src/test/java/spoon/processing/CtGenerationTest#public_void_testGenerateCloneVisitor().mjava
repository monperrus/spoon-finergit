@Test
public
void
testGenerateCloneVisitor
(
)
throws
Exception
{
System
.
setProperty
(
"line.separator"
,
"\n"
)
;
final
Launcher
launcher
=
new
Launcher
(
)
;
launcher
.
getEnvironment
(
)
.
setNoClasspath
(
true
)
;
launcher
.
getEnvironment
(
)
.
setCommentEnabled
(
true
)
;
launcher
.
getEnvironment
(
)
.
useTabulations
(
true
)
;
launcher
.
setSourceOutputDirectory
(
"./target/generated/"
)
;
launcher
.
addInputResource
(
"./src/main/java/spoon/reflect/code"
)
;
launcher
.
addInputResource
(
"./src/main/java/spoon/reflect/declaration"
)
;
launcher
.
addInputResource
(
"./src/main/java/spoon/reflect/reference"
)
;
launcher
.
addInputResource
(
"./src/main/java/spoon/reflect/internal"
)
;
launcher
.
addInputResource
(
"./src/main/java/spoon/support/reflect/code"
)
;
launcher
.
addInputResource
(
"./src/main/java/spoon/support/reflect/declaration"
)
;
launcher
.
addInputResource
(
"./src/main/java/spoon/support/reflect/reference"
)
;
launcher
.
addInputResource
(
"./src/main/java/spoon/support/reflect/internal"
)
;
launcher
.
addInputResource
(
"./src/main/java/spoon/reflect/visitor/CtScanner.java"
)
;
launcher
.
addInputResource
(
"./src/main/java/spoon/reflect/visitor/CtInheritanceScanner.java"
)
;
launcher
.
addInputResource
(
"./src/main/java/spoon/generating/clone/"
)
;
launcher
.
addProcessor
(
new
CloneVisitorGenerator
(
)
)
;
launcher
.
setOutputFilter
(
new
RegexFilter
(
"spoon.support.visitor.clone.*"
)
)
;
launcher
.
run
(
)
;
CtClass
<
Object
>
actual
=
build
(
new
File
(
launcher
.
getModelBuilder
(
)
.
getSourceOutputDirectory
(
)
+
"/spoon/support/visitor/clone/CloneBuilder.java"
)
)
.
Class
(
)
.
get
(
"spoon.support.visitor.clone.CloneBuilder"
)
;
CtClass
<
Object
>
expected
=
build
(
new
File
(
"./src/main/java/spoon/support/visitor/clone/CloneBuilder.java"
)
)
.
Class
(
)
.
get
(
"spoon.support.visitor.clone.CloneBuilder"
)
;
try
{
assertThat
(
actual
)
.
isEqualTo
(
expected
)
;
}
catch
(
AssertionError
e
)
{
throw
new
ComparisonFailure
(
"CloneBuilder different"
,
expected
.
toString
(
)
,
actual
.
toString
(
)
)
;
}
actual
=
build
(
new
File
(
launcher
.
getModelBuilder
(
)
.
getSourceOutputDirectory
(
)
+
"/spoon/support/visitor/clone/CloneVisitor.java"
)
)
.
Class
(
)
.
get
(
"spoon.support.visitor.clone.CloneVisitor"
)
;
expected
=
build
(
new
File
(
"./src/main/java/spoon/support/visitor/clone/CloneVisitor.java"
)
)
.
Class
(
)
.
get
(
"spoon.support.visitor.clone.CloneVisitor"
)
;
try
{
assertThat
(
actual
)
.
isEqualTo
(
expected
)
;
}
catch
(
AssertionError
e
)
{
throw
new
ComparisonFailure
(
"CloneVisitor different"
,
expected
.
toString
(
)
,
actual
.
toString
(
)
)
;
}
}
