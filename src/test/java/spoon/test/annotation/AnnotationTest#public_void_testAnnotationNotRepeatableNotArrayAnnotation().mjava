@Test
public
void
testAnnotationNotRepeatableNotArrayAnnotation
(
)
{
Launcher
spoon
=
new
Launcher
(
)
;
spoon
.
addInputResource
(
"./src/test/java/spoon/test/annotation/testclasses/notrepeatable/StringAnnot.java"
)
;
spoon
.
buildModel
(
)
;
CtMethod
aMethod
=
spoon
.
getFactory
(
)
.
createMethod
(
)
.
setSimpleName
(
(
"mamethod"
)
)
;
spoon
.
getFactory
(
)
.
Annotation
(
)
.
annotate
(
aMethod
,
StringAnnot
.
class
,
"value"
,
"foo"
)
;
assertEquals
(
1
,
aMethod
.
getAnnotations
(
)
.
size
(
)
)
;
String
methodContent
=
aMethod
.
toString
(
)
;
assertTrue
(
"Content: "
+
methodContent
,
methodContent
.
contains
(
"@spoon.test.annotation.testclasses.notrepeatable.StringAnnot(\"foo\")"
)
)
;
try
{
spoon
.
getFactory
(
)
.
Annotation
(
)
.
annotate
(
aMethod
,
StringAnnot
.
class
,
"value"
,
"bar"
)
;
methodContent
=
aMethod
.
toString
(
)
;
fail
(
"You should not be able to add two values to StringAnnot annotation: "
+
methodContent
)
;
}
catch
(
SpoonException
e
)
{
assertEquals
(
"cannot assign an array to a non-array annotation element"
,
e
.
getMessage
(
)
)
;
}
}
