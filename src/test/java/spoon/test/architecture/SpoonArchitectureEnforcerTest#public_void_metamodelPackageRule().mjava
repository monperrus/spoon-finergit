@Test
public
void
metamodelPackageRule
(
)
throws
Exception
{
List
<
String
>
exceptions
=
Arrays
.
asList
(
"CtWildcardStaticTypeMemberReferenceImpl"
,
"InvisibleArrayConstructorImpl"
)
;
SpoonAPI
implementations
=
new
Launcher
(
)
;
implementations
.
addInputResource
(
"src/main/java/spoon/support/reflect/declaration"
)
;
implementations
.
addInputResource
(
"src/main/java/spoon/support/reflect/code"
)
;
implementations
.
addInputResource
(
"src/main/java/spoon/support/reflect/reference"
)
;
implementations
.
buildModel
(
)
;
SpoonAPI
interfaces
=
new
Launcher
(
)
;
interfaces
.
addInputResource
(
"src/main/java/spoon/reflect/declaration"
)
;
interfaces
.
addInputResource
(
"src/main/java/spoon/reflect/code"
)
;
interfaces
.
addInputResource
(
"src/main/java/spoon/reflect/reference"
)
;
interfaces
.
addInputResource
(
"src/main/java/spoon/support/DefaultCoreFactory.java"
)
;
interfaces
.
buildModel
(
)
;
for
(
CtType
<
?
>
implType
:
implementations
.
getModel
(
)
.
getAllTypes
(
)
)
{
if
(
!
exceptions
.
contains
(
implType
.
getSimpleName
(
)
)
)
{
String
impl
=
implType
.
getQualifiedName
(
)
.
replace
(
".support"
,
""
)
.
replace
(
"Impl"
,
""
)
;
CtType
interfaceType
=
interfaces
.
getFactory
(
)
.
Type
(
)
.
get
(
impl
)
;
assertTrue
(
implType
.
getReference
(
)
.
isSubtypeOf
(
interfaceType
.
getReference
(
)
)
)
;
}
}
}
