@Test
public
void
testInterfacesAreCtScannable
(
)
{
Launcher
interfaces
=
new
Launcher
(
)
;
interfaces
.
addInputResource
(
"src/main/java/spoon/support"
)
;
interfaces
.
addInputResource
(
"src/main/java/spoon/reflect/declaration"
)
;
interfaces
.
addInputResource
(
"src/main/java/spoon/reflect/code"
)
;
interfaces
.
addInputResource
(
"src/main/java/spoon/reflect/reference"
)
;
interfaces
.
addInputResource
(
"src/main/java/spoon/support/reflect/declaration"
)
;
interfaces
.
addInputResource
(
"src/main/java/spoon/support/reflect/code"
)
;
interfaces
.
addInputResource
(
"src/main/java/spoon/support/reflect/reference"
)
;
interfaces
.
addInputResource
(
"src/main/java/spoon/reflect/visitor/CtScanner.java"
)
;
interfaces
.
buildModel
(
)
;
CtClass
<
?
>
ctScanner
=
interfaces
.
getFactory
(
)
.
Class
(
)
.
get
(
CtInheritanceScanner
.
class
)
;
List
<
String
>
missingMethods
=
new
ArrayList
<
>
(
)
;
new
SpoonMetaModel
(
interfaces
.
getFactory
(
)
)
.
getConcepts
(
)
.
forEach
(
mmConcept
->
{
if
(
mmConcept
.
getKind
(
)
==
ABSTRACT
&&
mmConcept
.
getModelInterface
(
)
!=
null
)
{
CtInterface
abstractIface
=
mmConcept
.
getModelInterface
(
)
;
String
methodName
=
"scan"
+
abstractIface
.
getSimpleName
(
)
;
if
(
ctScanner
.
getMethodsByName
(
methodName
)
.
isEmpty
(
)
)
{
missingMethods
.
add
(
methodName
)
;
}
}
}
)
;
assertTrue
(
"The following methods are missing in CtScanner: \n"
+
StringUtils
.
join
(
missingMethods
,
"\n"
)
,
missingMethods
.
isEmpty
(
)
)
;
}
