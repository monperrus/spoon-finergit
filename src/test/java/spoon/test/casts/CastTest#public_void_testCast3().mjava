@Test
public
void
testCast3
(
)
{
CtClass
<
?
>
clazz
=
factory
.
Code
(
)
.
createCodeSnippetStatement
(
""
+
"class X<A> {"
+
"void addConsumedAnnotationType(Class<? extends A> annotationType) {}\n"
+
"public void foo() {"
+
" Class<?> x = null;"
+
" addConsumedAnnotationType((Class<A>) x);"
+
"}"
+
"};"
)
.
compile
(
)
;
CtMethod
<
?
>
foo
=
clazz
.
getElements
(
new
NamedElementFilter
<
>
(
CtMethod
.
class
,
"foo"
)
)
.
get
(
0
)
;
CtVariableRead
<
?
>
a
=
(
CtVariableRead
<
?
>
)
clazz
.
getElements
(
new
TypeFilter
<
>
(
CtVariableRead
.
class
)
)
.
get
(
0
)
;
assertEquals
(
1
,
a
.
getTypeCasts
(
)
.
size
(
)
)
;
assertEquals
(
"addConsumedAnnotationType(((java.lang.Class<A>) (x)))"
,
foo
.
getBody
(
)
.
getStatements
(
)
.
get
(
1
)
.
toString
(
)
)
;
}
