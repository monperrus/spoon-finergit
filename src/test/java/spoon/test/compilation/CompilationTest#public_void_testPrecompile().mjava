@Test
public
void
testPrecompile
(
)
{
Launcher
l
=
new
Launcher
(
)
;
l
.
setArgs
(
new
String
[
]
{
"-i"
,
"src/test/resources/compilation/"
}
)
;
l
.
buildModel
(
)
;
CtClass
klass
=
l
.
getFactory
(
)
.
Class
(
)
.
get
(
"compilation.Bar"
)
;
try
{
klass
.
getSuperInterfaces
(
)
.
toArray
(
new
CtTypeReference
[
]
)
[
0
]
.
getActualClass
(
)
;
fail
(
)
;
}
catch
(
SpoonClassNotFoundException
ignore
)
{
}
Launcher
l2
=
new
Launcher
(
)
;
l2
.
setArgs
(
new
String
[
]
{
"--precompile"
,
"-i"
,
"src/test/resources/compilation/"
}
)
;
l2
.
buildModel
(
)
;
CtClass
klass2
=
l2
.
getFactory
(
)
.
Class
(
)
.
get
(
"compilation.Bar"
)
;
Class
actualClass
=
klass2
.
getSuperInterfaces
(
)
.
toArray
(
new
CtTypeReference
[
]
)
[
0
]
.
getActualClass
(
)
;
assertNotNull
(
actualClass
)
;
assertEquals
(
"IBar"
,
actualClass
.
getSimpleName
(
)
)
;
Launcher
l3
=
new
Launcher
(
)
;
l3
.
setArgs
(
new
String
[
]
{
"--precompile"
,
"-i"
,
"src/test/resources/compilation/"
,
"-p"
,
"compilation.SimpleProcessor"
}
)
;
l3
.
run
(
)
;
}
