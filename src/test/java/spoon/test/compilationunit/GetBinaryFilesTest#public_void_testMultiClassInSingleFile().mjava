@Test
public
void
testMultiClassInSingleFile
(
)
throws
IOException
{
final
String
input
=
"./src/test/resources/compilation/compilation-tests/"
;
final
Launcher
launcher
=
new
Launcher
(
)
;
launcher
.
addInputResource
(
input
)
;
launcher
.
setBinaryOutputDirectory
(
tmpFolder
.
getRoot
(
)
)
;
launcher
.
buildModel
(
)
;
launcher
.
getModelBuilder
(
)
.
compile
(
SpoonModelBuilder
.
InputType
.
FILES
)
;
final
Map
<
String
,
CompilationUnit
>
cus
=
launcher
.
getFactory
(
)
.
CompilationUnit
(
)
.
getMap
(
)
;
assertEquals
(
2
,
cus
.
size
(
)
)
;
final
List
<
File
>
ibarBinaries
=
cus
.
get
(
new
File
(
input
,
"IBar.java"
)
.
getCanonicalFile
(
)
.
getAbsolutePath
(
)
)
.
getBinaryFiles
(
)
;
assertEquals
(
1
,
ibarBinaries
.
size
(
)
)
;
assertEquals
(
"IBar.class"
,
ibarBinaries
.
get
(
0
)
.
getName
(
)
)
;
assertTrue
(
ibarBinaries
.
get
(
0
)
.
isFile
(
)
)
;
final
List
<
File
>
barBinaries
=
cus
.
get
(
new
File
(
input
,
"Bar.java"
)
.
getCanonicalFile
(
)
.
getAbsolutePath
(
)
)
.
getBinaryFiles
(
)
;
assertEquals
(
2
,
barBinaries
.
size
(
)
)
;
assertEquals
(
"Bar.class"
,
barBinaries
.
get
(
0
)
.
getName
(
)
)
;
assertEquals
(
"FooEx.class"
,
barBinaries
.
get
(
1
)
.
getName
(
)
)
;
assertTrue
(
barBinaries
.
get
(
0
)
.
isFile
(
)
)
;
assertTrue
(
barBinaries
.
get
(
1
)
.
isFile
(
)
)
;
}
