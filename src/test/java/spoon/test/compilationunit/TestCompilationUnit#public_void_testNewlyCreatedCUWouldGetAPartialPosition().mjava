@Test
public
void
testNewlyCreatedCUWouldGetAPartialPosition
(
)
throws
IOException
{
final
Launcher
launcher
=
new
Launcher
(
)
;
assertTrue
(
launcher
.
getFactory
(
)
.
CompilationUnit
(
)
.
getMap
(
)
.
isEmpty
(
)
)
;
CtClass
myFooClass
=
launcher
.
getFactory
(
)
.
createClass
(
"my.foo.MyClass"
)
;
assertEquals
(
SourcePosition
.
NOPOSITION
,
myFooClass
.
getPosition
(
)
)
;
CompilationUnit
cu
=
launcher
.
getFactory
(
)
.
CompilationUnit
(
)
.
getOrCreate
(
myFooClass
)
;
assertNotNull
(
cu
)
;
assertSame
(
cu
,
launcher
.
getFactory
(
)
.
CompilationUnit
(
)
.
getOrCreate
(
myFooClass
)
)
;
SourcePosition
sourcePosition
=
myFooClass
.
getPosition
(
)
;
assertTrue
(
sourcePosition
instanceof
PartialSourcePositionImpl
)
;
assertSame
(
cu
,
sourcePosition
.
getCompilationUnit
(
)
)
;
File
f
=
new
File
(
Launcher
.
OUTPUTDIR
,
"my/foo/MyClass.java"
)
;
assertEquals
(
f
.
getCanonicalFile
(
)
,
cu
.
getFile
(
)
)
;
}
