private
void
checkTypeParamErasureOfExecutable
(
CtTypeParameter
typeParam
)
throws
NoSuchFieldException
,
SecurityException
{
CtExecutable
<
?
>
exec
=
(
CtExecutable
<
?
>
)
typeParam
.
getParent
(
)
;
CtParameter
<
?
>
param
=
exec
.
filterChildren
(
new
NamedElementFilter
<
>
(
CtParameter
.
class
,
"param"
+
typeParam
.
getSimpleName
(
)
)
)
.
first
(
)
;
assertNotNull
(
"Missing param"
+
typeParam
.
getSimpleName
(
)
+
" in "
+
exec
.
getSignature
(
)
,
param
)
;
int
paramIdx
=
exec
.
getParameters
(
)
.
indexOf
(
param
)
;
Class
declClass
=
exec
.
getParent
(
CtType
.
class
)
.
getActualClass
(
)
;
Executable
declExec
;
if
(
exec
instanceof
CtConstructor
)
{
declExec
=
declClass
.
getDeclaredConstructors
(
)
[
0
]
;
}
else
{
declExec
=
getMethodByName
(
declClass
,
exec
.
getSimpleName
(
)
)
;
}
Class
<
?
>
paramType
=
declExec
.
getParameterTypes
(
)
[
paramIdx
]
;
assertEquals
(
"TypeErasure of executable param "
+
getTypeParamIdentification
(
typeParam
)
,
paramType
.
getName
(
)
,
typeParam
.
getTypeErasure
(
)
.
toString
(
)
)
;
}
