@Test
public
void
testClassAccessCreatedFromFactories
(
)
throws
Exception
{
final
CtType
<
Foo
>
foo
=
buildClass
(
Foo
.
class
)
;
assertEquals
(
1
,
foo
.
getAnnotations
(
)
.
size
(
)
)
;
assertEquals
(
0
,
foo
.
getAnnotations
(
)
.
get
(
0
)
.
getElementValues
(
)
.
size
(
)
)
;
foo
.
getFactory
(
)
.
Annotation
(
)
.
annotate
(
foo
,
Foo
.
Bar
.
class
,
"clazz"
,
Foo
.
class
)
;
assertEquals
(
1
,
foo
.
getAnnotations
(
)
.
size
(
)
)
;
assertEquals
(
1
,
foo
.
getAnnotations
(
)
.
get
(
0
)
.
getElementValues
(
)
.
size
(
)
)
;
assertTrue
(
foo
.
getAnnotations
(
)
.
get
(
0
)
.
getElementValues
(
)
.
get
(
"clazz"
)
instanceof
CtFieldRead
)
;
assertEquals
(
"spoon.test.factory.testclasses.Foo.class"
,
foo
.
getAnnotations
(
)
.
get
(
0
)
.
getElementValues
(
)
.
get
(
"clazz"
)
.
toString
(
)
)
;
foo
.
getFactory
(
)
.
Annotation
(
)
.
annotate
(
foo
,
Foo
.
Bar
.
class
,
"classes"
,
new
Class
[
]
{
Foo
.
class
}
)
;
assertEquals
(
1
,
foo
.
getAnnotations
(
)
.
size
(
)
)
;
assertEquals
(
2
,
foo
.
getAnnotations
(
)
.
get
(
0
)
.
getElementValues
(
)
.
size
(
)
)
;
assertTrue
(
foo
.
getAnnotations
(
)
.
get
(
0
)
.
getElementValues
(
)
.
get
(
"classes"
)
instanceof
List
)
;
assertEquals
(
1
,
(
(
List
<
CtExpression
>
)
foo
.
getAnnotations
(
)
.
get
(
0
)
.
getElementValues
(
)
.
get
(
"classes"
)
)
.
size
(
)
)
;
assertEquals
(
"spoon.test.factory.testclasses.Foo.class"
,
(
(
List
<
CtExpression
>
)
foo
.
getAnnotations
(
)
.
get
(
0
)
.
getElementValues
(
)
.
get
(
"classes"
)
)
.
get
(
0
)
.
toString
(
)
)
;
}
