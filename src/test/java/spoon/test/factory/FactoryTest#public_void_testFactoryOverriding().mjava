@Test
public
void
testFactoryOverriding
(
)
throws
Exception
{
@SuppressWarnings("serial")
class
MyCtMethod
extends
CtMethodImpl
<
T
>
{
}
;
@SuppressWarnings("serial")
final
CoreFactory
specialCoreFactory
=
new
DefaultCoreFactory
(
)
{
@Override
public
<
T
>
CtMethod
<
T
>
createMethod
(
)
{
return
new
MyCtMethod
<
T
>
(
)
;
}
}
;
Launcher
launcher
=
new
Launcher
(
)
{
@Override
public
Factory
createFactory
(
)
{
return
new
FactoryImpl
(
specialCoreFactory
,
new
StandardEnvironment
(
)
)
;
}
}
;
CtClass
<
?
>
type
=
build
(
"spoon.test"
,
"SampleClass"
,
launcher
.
getFactory
(
)
)
;
CtMethod
<
?
>
m
=
type
.
getMethodsByName
(
"method3"
)
.
get
(
0
)
;
assertTrue
(
m
instanceof
MyCtMethod
)
;
}
