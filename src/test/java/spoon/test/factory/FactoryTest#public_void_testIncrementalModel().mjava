@Test
public
void
testIncrementalModel
(
)
throws
Exception
{
SpoonAPI
spoon
=
new
Launcher
(
)
;
spoon
.
addInputResource
(
"src/test/java/spoon/test/factory/testclasses"
)
;
spoon
.
buildModel
(
)
;
assertEquals
(
1
,
spoon
.
getModel
(
)
.
getAllTypes
(
)
.
size
(
)
)
;
CtModel
model
=
spoon
.
getModel
(
)
;
model
.
processWith
(
new
AbstractProcessor
<
CtMethod
>
(
)
{
@Override
public
void
process
(
CtMethod
element
)
{
element
.
setDefaultMethod
(
false
)
;
}
}
)
;
SpoonAPI
spoon2
=
new
Launcher
(
)
;
spoon2
.
addInputResource
(
"src/test/java/spoon/test/factory/testclasses2"
)
;
spoon2
.
buildModel
(
)
;
assertEquals
(
1
,
spoon2
.
getModel
(
)
.
getAllTypes
(
)
.
size
(
)
)
;
model
.
getRootPackage
(
)
.
addPackage
(
spoon2
.
getModel
(
)
.
getRootPackage
(
)
)
;
assertEquals
(
6
,
model
.
getAllPackages
(
)
.
size
(
)
)
;
assertEquals
(
2
,
model
.
getAllTypes
(
)
.
size
(
)
)
;
assertEquals
(
1
,
model
.
getElements
(
new
AbstractFilter
<
CtPackage
>
(
)
{
@Override
public
boolean
matches
(
CtPackage
element
)
{
return
"spoon.test.factory.testclasses2"
.
equals
(
element
.
getQualifiedName
(
)
)
;
}
}
)
.
size
(
)
)
;
}
