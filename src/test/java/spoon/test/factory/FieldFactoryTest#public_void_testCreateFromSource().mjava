@Test
public
void
testCreateFromSource
(
)
throws
Exception
{
CtClass
<
?
>
target
=
build
(
"spoon.test"
,
"SampleClass"
)
;
Factory
factory
=
build
(
Foo
.
class
,
Bar
.
class
,
SuperClass
.
class
)
;
final
CtClass
<
Object
>
type
=
factory
.
Class
(
)
.
get
(
Foo
.
class
)
;
CtField
<
?
>
source
=
type
.
getField
(
"i"
)
;
FieldFactory
ff
=
type
.
getFactory
(
)
.
Field
(
)
;
TypeFactory
tf
=
type
.
getFactory
(
)
.
Type
(
)
;
ff
.
create
(
target
,
source
)
;
CtField
<
?
>
field
=
target
.
getField
(
"i"
)
;
Assert
.
assertEquals
(
"i"
,
field
.
getSimpleName
(
)
)
;
CtTypeReference
<
?
>
tref
=
tf
.
createReference
(
"int"
)
;
Assert
.
assertEquals
(
tref
,
field
.
getType
(
)
)
;
CtElement
parent
=
field
.
getParent
(
)
;
Assert
.
assertTrue
(
parent
instanceof
CtClass
<
?
>
)
;
Assert
.
assertEquals
(
"SampleClass"
,
(
(
CtClass
<
?
>
)
parent
)
.
getSimpleName
(
)
)
;
}
