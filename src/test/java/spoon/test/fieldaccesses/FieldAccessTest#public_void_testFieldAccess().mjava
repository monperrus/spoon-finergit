@Test
public
void
testFieldAccess
(
)
throws
Exception
{
CtType
<
?
>
type
=
build
(
"spoon.test.fieldaccesses.testclasses"
,
"TargetedAccessPosition"
)
;
List
<
Object
>
list1
=
type
.
filterChildren
(
new
TypeFilter
<
>
(
CtFieldWrite
.
class
)
)
.
list
(
)
;
assertEquals
(
1
,
list1
.
size
(
)
)
;
List
<
CtFieldRead
>
list2
=
type
.
filterChildren
(
new
TypeFilter
<
>
(
CtFieldRead
.
class
)
)
.
list
(
)
;
assertEquals
(
3
,
list2
.
size
(
)
)
;
Collections
.
reverse
(
list2
)
;
for
(
CtFieldRead
r
:
list2
)
{
CtCodeSnippetExpression
s
=
r
.
getFactory
(
)
.
createCodeSnippetExpression
(
"f("
+
r
.
toString
(
)
+
")"
)
;
r
.
replace
(
s
)
;
}
assertEquals
(
"f(f(f(t.ta).ta).ta).ta = t"
,
type
.
getMethodsByName
(
"foo"
)
.
get
(
0
)
.
getBody
(
)
.
getStatement
(
1
)
.
toString
(
)
)
;
}
