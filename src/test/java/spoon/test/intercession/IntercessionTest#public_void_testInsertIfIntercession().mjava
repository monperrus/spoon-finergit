@Test
public
void
testInsertIfIntercession
(
)
{
String
ifCode
=
"if (1 == 0)\n"
+
"    return 1;\n"
+
" else\n"
+
"    return 0;\n"
+
""
;
CtClass
<
?
>
clazz
=
factory
.
Code
(
)
.
createCodeSnippetStatement
(
""
+
"class X {"
+
"public int bar() {"
+
ifCode
+
"}"
+
"};"
)
.
compile
(
)
;
CtMethod
<
?
>
foo
=
(
CtMethod
<
?
>
)
clazz
.
getMethods
(
)
.
toArray
(
)
[
0
]
;
CtBlock
<
?
>
body
=
foo
.
getBody
(
)
;
assertEquals
(
1
,
body
.
getStatements
(
)
.
size
(
)
)
;
CtIf
ifStmt
=
(
CtIf
)
foo
.
getBody
(
)
.
getStatements
(
)
.
get
(
0
)
;
String
s
=
ifStmt
.
toString
(
)
.
replace
(
"\r"
,
""
)
;
assertEquals
(
ifCode
,
s
)
;
CtBlock
<
?
>
r1
=
ifStmt
.
getThenStatement
(
)
;
CtBlock
<
?
>
r2
=
ifStmt
.
getElseStatement
(
)
;
assertTrue
(
r1
.
isImplicit
(
)
)
;
assertTrue
(
r2
.
isImplicit
(
)
)
;
ifStmt
.
setThenStatement
(
r2
)
;
assertSame
(
r2
,
ifStmt
.
getThenStatement
(
)
)
;
ifStmt
.
setElseStatement
(
r1
)
;
assertSame
(
r1
,
ifStmt
.
getElseStatement
(
)
)
;
s
=
ifStmt
.
toString
(
)
.
replace
(
"\r"
,
""
)
;
String
ifCodeNew
=
"if (1 == 0)\n"
+
"    return 0;\n"
+
" else\n"
+
"    return 1;\n"
+
""
;
assertEquals
(
ifCodeNew
,
s
)
;
}
