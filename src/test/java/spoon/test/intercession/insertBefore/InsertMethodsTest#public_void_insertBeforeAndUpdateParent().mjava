@Test
public
void
insertBeforeAndUpdateParent
(
)
throws
Exception
{
Launcher
spoon
=
new
Launcher
(
)
;
Factory
factory
=
spoon
.
createFactory
(
)
;
spoon
.
createCompiler
(
factory
,
SpoonResourceHelper
.
resources
(
"./src/test/resources/spoon/test/intercession/insertBefore/InsertBeforeExample2.java"
)
)
.
build
(
)
;
List
<
CtWhile
>
elements
=
Query
.
getElements
(
factory
,
new
TypeFilter
<
CtWhile
>
(
CtWhile
.
class
)
)
;
assertTrue
(
1
==
elements
.
size
(
)
)
;
CtWhile
theWhile
=
elements
.
get
(
0
)
;
CtElement
parent
=
theWhile
.
getParent
(
)
;
assertTrue
(
parent
instanceof
CtBlock
)
;
assertTrue
(
parent
.
isImplicit
(
)
)
;
CtIf
ifParent
=
(
CtIf
)
parent
.
getParent
(
)
;
CtStatement
insert
=
factory
.
Code
(
)
.
createCodeSnippetStatement
(
"System.out.println()"
)
;
theWhile
.
insertBefore
(
insert
)
;
CtElement
newParent
=
theWhile
.
getParent
(
)
;
assertTrue
(
newParent
!=
ifParent
)
;
assertTrue
(
newParent
instanceof
CtBlock
)
;
assertFalse
(
newParent
.
isImplicit
(
)
)
;
}
