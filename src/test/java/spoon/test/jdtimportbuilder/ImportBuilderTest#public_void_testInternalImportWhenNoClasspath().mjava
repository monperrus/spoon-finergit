@Test
public
void
testInternalImportWhenNoClasspath
(
)
{
Launcher
spoon
=
new
Launcher
(
)
;
spoon
.
addInputResource
(
"./src/test/resources/noclasspath/Attachment.java"
)
;
spoon
.
getEnvironment
(
)
.
setAutoImports
(
true
)
;
spoon
.
getEnvironment
(
)
.
setNoClasspath
(
true
)
;
spoon
.
buildModel
(
)
;
CtClass
classA
=
spoon
.
getFactory
(
)
.
Class
(
)
.
get
(
"it.feio.android.omninotes.models.Attachment"
)
;
CompilationUnit
unitA
=
spoon
.
getFactory
(
)
.
CompilationUnit
(
)
.
getMap
(
)
.
get
(
classA
.
getPosition
(
)
.
getFile
(
)
.
getPath
(
)
)
;
assertTrue
(
unitA
.
getImports
(
)
.
stream
(
)
.
filter
(
i
->
!
(
i
instanceof
CtUnresolvedImport
)
)
.
collect
(
Collectors
.
toList
(
)
)
.
isEmpty
(
)
)
;
assertEquals
(
3
,
unitA
.
getImports
(
)
.
size
(
)
)
;
Set
<
String
>
importRefs
=
unitA
.
getImports
(
)
.
stream
(
)
.
map
(
i
->
(
(
CtUnresolvedImport
)
i
)
.
getUnresolvedReference
(
)
)
.
collect
(
Collectors
.
toSet
(
)
)
;
assertTrue
(
importRefs
.
contains
(
"android.net.Uri"
)
)
;
assertTrue
(
importRefs
.
contains
(
"android.os.Parcel"
)
)
;
assertTrue
(
importRefs
.
contains
(
"android.os.Parcelable"
)
)
;
}
