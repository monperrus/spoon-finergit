@Test
public
void
testLambdaExpressionInIfConditional
(
)
{
final
CtLambda
<
?
>
lambda
=
getLambdaInFooByNumber
(
7
)
;
assertTypedBy
(
Predicate
.
class
,
lambda
.
getType
(
)
)
;
assertParametersSizeIs
(
1
,
lambda
.
getParameters
(
)
)
;
final
CtParameter
<
?
>
parameter
=
lambda
.
getParameters
(
)
.
get
(
0
)
;
assertParameterTypedBy
(
Foo
.
Person
.
class
,
parameter
)
;
assertParameterIsNamedBy
(
"p"
,
parameter
)
;
assertHasExpressionBody
(
lambda
)
;
final
CtMethod
<
?
>
method
=
foo
.
getElements
(
new
NamedElementFilter
<
>
(
CtMethod
.
class
,
"m8"
)
)
.
get
(
0
)
;
final
CtIf
condition
=
method
.
getElements
(
new
AbstractFilter
<
CtIf
>
(
CtIf
.
class
)
{
@Override
public
boolean
matches
(
CtIf
element
)
{
return
true
;
}
}
)
.
get
(
0
)
;
final
String
expected
=
"if (((Predicate<Person>) (( p) -> p.age > 18)).test(new Person(10))) {"
+
System
.
lineSeparator
(
)
+
"    System.err.println(\"Enjoy, you have more than 18.\");"
+
System
.
lineSeparator
(
)
+
"}"
;
assertEquals
(
"Condition must be well printed"
,
expected
,
printByPrinter
(
condition
)
)
;
}
