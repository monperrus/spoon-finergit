private
void
checkModelIsTree
(
CtPackage
rootPackage
)
{
PrinterHelper
problems
=
new
PrinterHelper
(
rootPackage
.
getFactory
(
)
.
getEnvironment
(
)
)
;
Map
<
CtElement
,
Exception
>
allElements
=
new
IdentityHashMap
<
>
(
)
;
rootPackage
.
filterChildren
(
null
)
.
forEach
(
(
CtElement
ele
)
->
{
Exception
secondStack
=
new
Exception
(
"STACK"
)
;
Exception
firstStack
=
allElements
.
put
(
ele
,
secondStack
)
;
if
(
firstStack
!=
null
)
{
problems
.
write
(
"The element "
+
ele
.
getClass
(
)
.
getSimpleName
(
)
)
.
writeln
(
)
.
incTab
(
)
.
write
(
ele
.
toString
(
)
)
.
writeln
(
)
.
write
(
"Is linked by these stacktraces"
)
.
writeln
(
)
.
write
(
"1) "
+
getStackTrace
(
firstStack
)
)
.
writeln
(
)
.
write
(
"2) "
+
getStackTrace
(
secondStack
)
)
.
writeln
(
)
.
decTab
(
)
;
}
}
)
;
String
report
=
problems
.
toString
(
)
;
if
(
report
.
length
(
)
>
0
)
{
Assert
.
fail
(
report
)
;
}
}
