/** 
 * is called once for each MMType, to initialize it.
 * @param type a class or inteface of the spoon model element
 * @param mmType to be initialize MMType
 */
private
void
initializeMMType
(
CtType
<
?
>
type
,
MMType
mmType
)
{
if
(
type
instanceof
CtInterface
<
?
>
)
{
CtInterface
<
?
>
iface
=
(
CtInterface
<
?
>
)
type
;
mmType
.
setModelClass
(
getImplementationOfInterface
(
iface
)
)
;
mmType
.
setModelInteface
(
iface
)
;
}
else
if
(
type
instanceof
CtClass
<
?
>
)
{
CtClass
<
?
>
clazz
=
(
CtClass
<
?
>
)
type
;
mmType
.
setModelClass
(
clazz
)
;
mmType
.
setModelInteface
(
getInterfaceOfImplementation
(
clazz
)
)
;
}
else
{
throw
new
SpoonException
(
"Unexpected spoon model type: "
+
type
.
getQualifiedName
(
)
)
;
}
if
(
mmType
.
getModelClass
(
)
!=
null
)
{
addFieldsOfType
(
mmType
,
mmType
.
getModelClass
(
)
)
;
}
if
(
mmType
.
getModelInteface
(
)
!=
null
)
{
addFieldsOfType
(
mmType
,
mmType
.
getModelInteface
(
)
)
;
}
mmType
.
getRole2field
(
)
.
forEach
(
(
role
,
mmField
)
->
{
mmField
.
sortByBestMatch
(
)
;
mmField
.
setValueType
(
mmField
.
detectValueType
(
)
)
;
}
)
;
}
