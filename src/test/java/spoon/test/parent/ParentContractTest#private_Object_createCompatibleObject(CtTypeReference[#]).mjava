private
Object
createCompatibleObject
(
CtTypeReference
<
?
>
parameterType
)
{
Class
<
?
>
c
=
parameterType
.
getActualClass
(
)
;
for
(
CtType
t
:
allInstantiableMetamodelInterfaces
)
{
if
(
c
.
isAssignableFrom
(
t
.
getActualClass
(
)
)
)
{
CtElement
argument
=
factory
.
Core
(
)
.
create
(
t
.
getActualClass
(
)
)
;
if
(
argument
instanceof
CtPackage
)
{
(
(
CtPackage
)
argument
)
.
setSimpleName
(
argument
.
getShortRepresentation
(
)
)
;
}
return
argument
;
}
}
if
(
Set
.
class
.
isAssignableFrom
(
c
)
)
{
HashSet
<
Object
>
objects
=
new
HashSet
<
>
(
)
;
objects
.
add
(
createCompatibleObject
(
parameterType
.
getActualTypeArguments
(
)
.
get
(
0
)
)
)
;
return
objects
;
}
if
(
Collection
.
class
.
isAssignableFrom
(
c
)
)
{
ArrayList
<
Object
>
objects
=
new
ArrayList
<
>
(
)
;
objects
.
add
(
createCompatibleObject
(
parameterType
.
getActualTypeArguments
(
)
.
get
(
0
)
)
)
;
return
objects
;
}
throw
new
IllegalArgumentException
(
"cannot instantiate "
+
parameterType
)
;
}
