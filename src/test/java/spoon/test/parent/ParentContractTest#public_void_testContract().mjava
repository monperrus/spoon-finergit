@Test
public
void
testContract
(
)
throws
Throwable
{
Object
o
=
instance
;
for
(
Method
setter
:
getMethodsToInvoke
(
toTest
)
)
{
if
(
o
instanceof
CtAnnotationType
&&
"addMethod"
.
equals
(
setter
.
getName
(
)
)
)
continue
;
if
(
o
instanceof
CtAnnotationType
&&
"addFormalTypeParameter"
.
equals
(
setter
.
getName
(
)
)
)
continue
;
if
(
o
instanceof
CtParameter
&&
"setDefaultExpression"
.
equals
(
setter
.
getName
(
)
)
)
continue
;
if
(
o
instanceof
CtCatchVariable
&&
"setDefaultExpression"
.
equals
(
setter
.
getName
(
)
)
)
continue
;
if
(
o
instanceof
CtConstructor
&&
"setType"
.
equals
(
setter
.
getName
(
)
)
)
continue
;
if
(
o
instanceof
CtInvocation
&&
"setType"
.
equals
(
setter
.
getName
(
)
)
)
continue
;
if
(
o
instanceof
CtConstructorCall
&&
"setType"
.
equals
(
setter
.
getName
(
)
)
)
continue
;
if
(
o
instanceof
CtNewClass
&&
"setType"
.
equals
(
setter
.
getName
(
)
)
)
continue
;
CtElement
mockedArgument
=
(
CtElement
)
mock
(
setter
.
getParameters
(
)
[
0
]
.
getType
(
)
,
Mockito
.
withSettings
(
)
.
extraInterfaces
(
Comparable
.
class
)
)
;
try
{
CtElement
receiver
=
(
CtElement
)
factory
.
Core
(
)
.
clone
(
o
)
;
setter
.
invoke
(
receiver
,
new
Object
[
]
{
mockedArgument
}
)
;
verify
(
mockedArgument
)
.
setParent
(
(
CtElement
)
receiver
)
;
}
catch
(
AssertionError
e
)
{
Assert
.
fail
(
"call setParent contract failed for "
+
setter
.
toString
(
)
+
" "
+
e
.
toString
(
)
)
;
}
}
}
