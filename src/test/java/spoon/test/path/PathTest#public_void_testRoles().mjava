@Test
public
void
testRoles
(
)
{
CtType
<
?
>
fooClass
=
factory
.
Package
(
)
.
get
(
"spoon.test.path.testclasses"
)
.
getType
(
"Foo"
)
;
CtPath
path
=
new
CtPathStringBuilder
(
)
.
fromString
(
".**/CtIf#else"
)
;
CtMethod
<
Object
>
method
=
fooClass
.
getMethod
(
"foo"
)
;
CtStatement
expected
=
(
(
CtIf
)
method
.
getBody
(
)
.
getStatement
(
2
)
)
.
getElseStatement
(
)
;
equals
(
path
,
expected
)
;
CtPath
absPath
=
path
.
evaluateOn
(
factory
.
getModel
(
)
.
getRootPackage
(
)
)
.
get
(
0
)
.
getPath
(
)
;
assertEquals
(
"#subPackage[name=spoon]#subPackage[name=test]#subPackage[name=path]#subPackage[name=testclasses]#containedType[name=Foo]#typeMember[index=2]#body#statement[index=2]#else"
,
absPath
.
toString
(
)
)
;
CtPath
subPath
=
absPath
.
relativePath
(
fooClass
)
;
assertEquals
(
"#typeMember[index=2]#body#statement[index=2]#else"
,
subPath
.
toString
(
)
)
;
assertSame
(
expected
,
subPath
.
evaluateOn
(
fooClass
)
.
get
(
0
)
)
;
CtPath
subPath2
=
absPath
.
relativePath
(
method
)
;
assertEquals
(
"#body#statement[index=2]#else"
,
subPath2
.
toString
(
)
)
;
assertSame
(
expected
,
subPath2
.
evaluateOn
(
method
)
.
get
(
0
)
)
;
equals
(
new
CtPathStringBuilder
(
)
.
fromString
(
".**#else"
)
,
expected
)
;
}
