@Test
public
void
testNoClasspathVariableAccessInInnerInterface
(
)
{
Launcher
launcher
=
new
Launcher
(
)
;
launcher
.
addInputResource
(
"./src/test/resources/noclasspath/lambdas/InheritedInterfacesWithLambda.java"
)
;
launcher
.
getEnvironment
(
)
.
setNoClasspath
(
true
)
;
CtModel
model
=
launcher
.
buildModel
(
)
;
List
<
CtInterface
>
allInterfaces
=
model
.
getElements
(
new
TypeFilter
<
>
(
CtInterface
.
class
)
)
;
assertEquals
(
1
,
allInterfaces
.
size
(
)
)
;
CtInterface
failing
=
allInterfaces
.
stream
(
)
.
filter
(
t
->
t
.
getSimpleName
(
)
.
equals
(
"Failing"
)
)
.
findFirst
(
)
.
get
(
)
;
assertEquals
(
"InheritedInterfacesWithLambda.java"
,
failing
.
getPosition
(
)
.
getFile
(
)
.
getName
(
)
)
;
assertEquals
(
3
,
failing
.
getPosition
(
)
.
getLine
(
)
)
;
CtLambda
lambda
=
model
.
getElements
(
new
TypeFilter
<
>
(
CtLambda
.
class
)
)
.
get
(
0
)
;
CtFieldRead
field
=
(
CtFieldRead
)
(
(
(
CtInvocation
)
lambda
.
getExpression
(
)
)
.
getTarget
(
)
)
;
assertEquals
(
"InheritedInterfacesWithLambda.Failing"
,
field
.
getVariable
(
)
.
getDeclaringType
(
)
.
toString
(
)
)
;
}
