@Test
public
void
testPositionOfAnnonymousType
(
)
throws
Exception
{
final
CtEnum
foo
=
(
CtEnum
)
buildClass
(
SomeEnum
.
class
)
;
String
classContent
=
getClassContent
(
foo
)
;
CtNewClass
<
?
>
newClass
=
(
CtNewClass
<
?
>
)
foo
.
getEnumValue
(
"X"
)
.
getDefaultExpression
(
)
;
CtClass
<
?
>
annonClass
=
newClass
.
getAnonymousClass
(
)
;
assertEquals
(
"{\n"
+
"		void m() {};\n"
+
"	}"
,
contentAtPosition
(
classContent
,
annonClass
.
getPosition
(
)
)
)
;
BodyHolderSourcePosition
bhsp
=
(
BodyHolderSourcePosition
)
annonClass
.
getPosition
(
)
;
int
start
=
annonClass
.
getPosition
(
)
.
getSourceStart
(
)
;
int
end
=
annonClass
.
getPosition
(
)
.
getSourceEnd
(
)
;
assertEquals
(
start
,
bhsp
.
getBodyStart
(
)
)
;
assertEquals
(
end
,
bhsp
.
getBodyEnd
(
)
)
;
assertEquals
(
start
-
1
,
bhsp
.
getNameEnd
(
)
)
;
assertEquals
(
start
,
bhsp
.
getModifierSourceStart
(
)
)
;
assertEquals
(
start
-
1
,
bhsp
.
getModifierSourceEnd
(
)
)
;
assertEquals
(
start
,
bhsp
.
getNameStart
(
)
)
;
assertEquals
(
start
-
1
,
bhsp
.
getNameEnd
(
)
)
;
}
