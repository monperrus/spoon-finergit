@Test
public
void
testPositionOfAnnonymousTypeByNewInterface
(
)
throws
Exception
{
final
CtType
<
?
>
foo
=
buildClass
(
AnnonymousClassNewIface
.
class
)
;
String
classContent
=
getClassContent
(
foo
)
;
CtLocalVariable
<
?
>
localVar
=
(
CtLocalVariable
<
?
>
)
foo
.
getMethodsByName
(
"m"
)
.
get
(
0
)
.
getBody
(
)
.
getStatement
(
0
)
;
CtNewClass
<
?
>
newClass
=
(
CtNewClass
<
?
>
)
localVar
.
getDefaultExpression
(
)
;
CtClass
<
?
>
annonClass
=
newClass
.
getAnonymousClass
(
)
;
BodyHolderSourcePosition
bhsp
=
(
BodyHolderSourcePosition
)
annonClass
.
getPosition
(
)
;
int
start
=
annonClass
.
getPosition
(
)
.
getSourceStart
(
)
;
int
end
=
annonClass
.
getPosition
(
)
.
getSourceEnd
(
)
;
assertEquals
(
"Consumer<Set<?>>() {\r\n"
+
"			@Override\r\n"
+
"			public void accept(Set<?> t) {\r\n"
+
"			}\r\n"
+
"		}"
,
contentAtPosition
(
classContent
,
start
,
end
)
)
;
assertEquals
(
"{\r\n"
+
"			@Override\r\n"
+
"			public void accept(Set<?> t) {\r\n"
+
"			}\r\n"
+
"		}"
,
contentAtPosition
(
classContent
,
bhsp
.
getBodyStart
(
)
,
bhsp
.
getBodyEnd
(
)
)
)
;
assertEquals
(
start
-
1
,
bhsp
.
getNameEnd
(
)
)
;
assertEquals
(
start
,
bhsp
.
getModifierSourceStart
(
)
)
;
assertEquals
(
start
-
1
,
bhsp
.
getModifierSourceEnd
(
)
)
;
assertEquals
(
start
,
bhsp
.
getNameStart
(
)
)
;
assertEquals
(
start
-
1
,
bhsp
.
getNameEnd
(
)
)
;
}
