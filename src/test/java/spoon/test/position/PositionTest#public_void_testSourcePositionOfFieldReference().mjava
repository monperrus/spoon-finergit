@Test
public
void
testSourcePositionOfFieldReference
(
)
throws
Exception
{
CtType
<
?
>
foo
=
ModelUtils
.
buildClass
(
cfg
->
{
cfg
.
getEnvironment
(
)
.
setCommentEnabled
(
true
)
;
cfg
.
getEnvironment
(
)
.
setAutoImports
(
true
)
;
}
,
FooField
.
class
)
;
String
classContent
=
getClassContent
(
foo
)
;
CtAssignment
<
?
,
?
>
assignment
=
(
CtAssignment
<
?
,
?
>
)
foo
.
getMethodsByName
(
"m"
)
.
get
(
0
)
.
getBody
(
)
.
getStatements
(
)
.
get
(
0
)
;
CtFieldWrite
<
?
>
fieldWrite
=
(
CtFieldWrite
<
?
>
)
assignment
.
getAssigned
(
)
;
assertEquals
(
"FooField.f.field2"
,
contentAtPosition
(
classContent
,
fieldWrite
.
getPosition
(
)
)
)
;
CtFieldRead
<
?
>
fieldRead
=
(
CtFieldRead
<
?
>
)
fieldWrite
.
getTarget
(
)
;
assertEquals
(
"FooField.f"
,
contentAtPosition
(
classContent
,
fieldRead
.
getPosition
(
)
)
)
;
CtFieldReference
<
?
>
fieldRef2
=
fieldRead
.
getVariable
(
)
;
assertEquals
(
"f"
,
contentAtPosition
(
classContent
,
fieldRef2
.
getPosition
(
)
)
)
;
}
