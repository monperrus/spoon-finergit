@Test
public
void
printerCanPrintInvocationWithoutException
(
)
throws
Exception
{
String
packageName
=
"spoon.test.subclass.prettyprinter"
;
String
className
=
"DefaultPrettyPrinterExample"
;
String
qualifiedName
=
packageName
+
"."
+
className
;
SpoonCompiler
comp
=
new
Launcher
(
)
.
createCompiler
(
)
;
List
<
SpoonResource
>
fileToBeSpooned
=
SpoonResourceHelper
.
resources
(
"./src/test/resources/printer-test/"
+
qualifiedName
.
replace
(
'.'
,
'/'
)
+
".java"
)
;
assertEquals
(
1
,
fileToBeSpooned
.
size
(
)
)
;
comp
.
addInputSources
(
fileToBeSpooned
)
;
List
<
SpoonResource
>
classpath
=
SpoonResourceHelper
.
resources
(
"./src/test/resources/printer-test/DefaultPrettyPrinterDependency.jar"
)
;
assertEquals
(
1
,
classpath
.
size
(
)
)
;
comp
.
setSourceClasspath
(
classpath
.
get
(
0
)
.
getPath
(
)
)
;
comp
.
build
(
)
;
Factory
factory
=
comp
.
getFactory
(
)
;
CtSimpleType
<
?
>
theClass
=
factory
.
Type
(
)
.
get
(
qualifiedName
)
;
List
<
CtInvocation
<
?
>
>
elements
=
Query
.
getElements
(
theClass
,
new
TypeFilter
<
CtInvocation
<
?
>
>
(
CtInvocation
.
class
)
)
;
assertEquals
(
3
,
elements
.
size
(
)
)
;
CtInvocation
<
?
>
mathAbsInvocation
=
elements
.
get
(
1
)
;
assertEquals
(
"java.lang.Math.abs(message.length())"
,
mathAbsInvocation
.
toString
(
)
)
;
}
