@Test
public
void
testPrintAMethodWithImports
(
)
throws
Exception
{
final
Launcher
launcher
=
new
Launcher
(
)
;
final
Factory
factory
=
launcher
.
getFactory
(
)
;
factory
.
getEnvironment
(
)
.
setAutoImports
(
true
)
;
final
SpoonCompiler
compiler
=
launcher
.
createCompiler
(
)
;
compiler
.
addInputSource
(
new
File
(
"./src/test/java/spoon/test/prettyprinter/testclasses/"
)
)
;
compiler
.
build
(
)
;
final
String
expected
=
"public List<?> aMethod() {"
+
nl
+
"    return new ArrayList<>();"
+
nl
+
"}"
;
final
CtClass
<
?
>
aClass
=
(
CtClass
<
?
>
)
factory
.
Type
(
)
.
get
(
AClass
.
class
)
;
DefaultJavaPrettyPrinter
printer
=
new
DefaultJavaPrettyPrinter
(
launcher
.
getEnvironment
(
)
)
;
printer
.
computeImports
(
aClass
)
;
String
computed
=
printer
.
scan
(
aClass
.
getMethodsByName
(
"aMethod"
)
.
get
(
0
)
)
.
toString
(
)
;
assertEquals
(
expected
,
computed
)
;
final
CtConstructorCall
<
?
>
constructorCall
=
aClass
.
getElements
(
new
TypeFilter
<
CtConstructorCall
<
?
>
>
(
CtConstructorCall
.
class
)
)
.
get
(
0
)
;
final
CtTypeReference
<
?
>
ctTypeReference
=
constructorCall
.
getType
(
)
.
getActualTypeArguments
(
)
.
get
(
0
)
;
assertTrue
(
ctTypeReference
instanceof
CtImplicitTypeReference
)
;
assertEquals
(
"Object"
,
ctTypeReference
.
getSimpleName
(
)
)
;
}
