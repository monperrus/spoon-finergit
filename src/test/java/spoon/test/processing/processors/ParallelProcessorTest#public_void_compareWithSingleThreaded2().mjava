@Test
public
void
compareWithSingleThreaded2
(
)
throws
IOException
{
AtomicReferenceArray
<
Integer
>
atomicCounter
=
createCounter
(
)
;
Processor
<
CtElement
>
p1
=
createProcessor
(
atomicCounter
,
0
)
;
new
FluentLauncher
(
)
.
inputResource
(
INPUT_FILES
)
.
processor
(
new
AbstractParallelProcessor
<
CtElement
>
(
Arrays
.
asList
(
p1
)
)
{
}
)
.
noClasspath
(
true
)
.
outputDirectory
(
folderFactory
.
newFolder
(
)
)
.
buildModel
(
)
;
AtomicInteger
singleThreadCounter
=
new
AtomicInteger
(
0
)
;
new
FluentLauncher
(
)
.
inputResource
(
INPUT_FILES
)
.
processor
(
new
AbstractProcessor
<
CtElement
>
(
)
{
@Override
public
void
process
(
CtElement
element
)
{
singleThreadCounter
.
incrementAndGet
(
)
;
}
}
)
.
noClasspath
(
true
)
.
outputDirectory
(
folderFactory
.
newFolder
(
)
)
.
buildModel
(
)
;
singleThreadCounter
.
set
(
singleThreadCounter
.
get
(
)
-
atomicCounter
.
get
(
0
)
)
;
assertTrue
(
singleThreadCounter
.
get
(
)
==
0
)
;
}
