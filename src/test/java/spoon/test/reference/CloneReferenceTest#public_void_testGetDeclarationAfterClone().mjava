@Test
public
void
testGetDeclarationAfterClone
(
)
{
Launcher
spoon
=
new
Launcher
(
)
;
List
<
String
>
names
=
Arrays
.
asList
(
"f1"
,
"f2"
,
"a"
,
"b"
,
"x"
,
"param"
,
"e"
)
;
spoon
.
addInputResource
(
"./src/test/resources/noclasspath/A2.java"
)
;
spoon
.
getEnvironment
(
)
.
setComplianceLevel
(
8
)
;
spoon
.
getEnvironment
(
)
.
setNoClasspath
(
true
)
;
spoon
.
buildModel
(
)
;
final
CtClass
<
Object
>
a
=
spoon
.
getFactory
(
)
.
Class
(
)
.
get
(
"A2"
)
;
for
(
String
name
:
names
)
{
CtVariable
var1
=
findVariable
(
a
,
name
)
;
CtVariable
var2
=
findReference
(
a
,
name
)
.
getDeclaration
(
)
;
assertTrue
(
var1
==
var2
)
;
}
CtClass
b
=
a
.
clone
(
)
;
for
(
String
name
:
names
)
{
CtVariable
var1
=
findVariable
(
b
,
name
)
;
CtVariableReference
refVar1
=
findReference
(
b
,
name
)
;
CtVariable
var2
=
refVar1
.
getDeclaration
(
)
;
assertTrue
(
"Var1 and var2 are not the same element"
,
var1
==
var2
)
;
}
}
