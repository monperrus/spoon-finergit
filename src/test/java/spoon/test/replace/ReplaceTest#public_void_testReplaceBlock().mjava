@Test
public
void
testReplaceBlock
(
)
throws
Exception
{
CtClass
<
?
>
foo
=
factory
.
Package
(
)
.
get
(
"spoon.test.replace"
)
.
getType
(
"Foo"
)
;
CtMethod
<
?
>
m
=
foo
.
getElements
(
new
NameFilter
<
CtMethod
<
?
>
>
(
"foo"
)
)
.
get
(
0
)
;
assertEquals
(
"foo"
,
m
.
getSimpleName
(
)
)
;
final
CtStatement
parent
=
m
.
getBody
(
)
.
getStatements
(
)
.
get
(
2
)
;
CtAssignment
<
?
,
?
>
assignment
=
(
CtAssignment
<
?
,
?
>
)
parent
;
CtExpression
<
Integer
>
s1
=
(
CtExpression
<
Integer
>
)
assignment
.
getAssignment
(
)
;
CtExpression
<
Integer
>
s2
=
factory
.
Code
(
)
.
createLiteral
(
3
)
;
assertEquals
(
"z = x + 1"
,
assignment
.
toString
(
)
)
;
assertEquals
(
"x + 1"
,
s1
.
toString
(
)
)
;
s1
.
replace
(
s2
)
;
assertSame
(
s2
,
assignment
.
getAssignment
(
)
)
;
assertEquals
(
"z = 3"
,
assignment
.
toString
(
)
)
;
assertEquals
(
parent
,
s2
.
getParent
(
)
)
;
s2
.
replace
(
s1
)
;
assertSame
(
s1
,
assignment
.
getAssignment
(
)
)
;
assertEquals
(
"z = x + 1"
,
assignment
.
toString
(
)
)
;
assertEquals
(
parent
,
s1
.
getParent
(
)
)
;
}
