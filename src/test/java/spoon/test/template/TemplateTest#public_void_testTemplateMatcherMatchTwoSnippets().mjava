@Test
public
void
testTemplateMatcherMatchTwoSnippets
(
)
{
Launcher
spoon
=
new
Launcher
(
)
;
spoon
.
addInputResource
(
"./src/test/java/spoon/test/template/testclasses/TwoSnippets.java"
)
;
spoon
.
addTemplateResource
(
new
FileSystemFile
(
"./src/test/java/spoon/test/template/testclasses/SecurityCheckerTemplate.java"
)
)
;
spoon
.
buildModel
(
)
;
Factory
factory
=
spoon
.
getFactory
(
)
;
CtClass
<
?
>
templateKlass
=
factory
.
Class
(
)
.
get
(
SecurityCheckerTemplate
.
class
)
;
CtMethod
templateMethod
=
(
CtMethod
)
templateKlass
.
getElements
(
new
NamedElementFilter
<
>
(
CtMethod
.
class
,
"matcher1"
)
)
.
get
(
0
)
;
CtIf
templateRoot
=
(
CtIf
)
templateMethod
.
getBody
(
)
.
getStatement
(
0
)
;
TemplateMatcher
matcher
=
new
TemplateMatcher
(
templateRoot
)
;
List
<
CtElement
>
matches
=
matcher
.
find
(
factory
.
getModel
(
)
.
getRootPackage
(
)
)
;
assertEquals
(
2
,
matches
.
size
(
)
)
;
CtElement
match1
=
matches
.
get
(
0
)
;
CtElement
match2
=
matches
.
get
(
1
)
;
assertTrue
(
match1
.
equals
(
match2
)
)
;
matches
=
factory
.
getModel
(
)
.
filterChildren
(
matcher
)
.
list
(
)
;
assertEquals
(
2
,
matches
.
size
(
)
)
;
match1
=
matches
.
get
(
0
)
;
match2
=
matches
.
get
(
1
)
;
assertTrue
(
match1
.
equals
(
match2
)
)
;
}
