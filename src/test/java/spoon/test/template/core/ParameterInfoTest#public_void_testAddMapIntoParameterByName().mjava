@Test
public
void
testAddMapIntoParameterByName
(
)
{
BiConsumer
<
ParameterInfo
,
ImmutableMap
>
checker
=
(
namedParam
,
empty
)
->
{
ImmutableMap
val
=
namedParam
.
addValueAs
(
empty
,
Collections
.
emptyMap
(
)
)
;
assertEquals
(
map
(
)
.
put
(
"map"
,
new
ImmutableMapImpl
(
)
)
,
val
.
asMap
(
)
)
;
val
=
namedParam
.
addValueAs
(
empty
,
map
(
)
.
put
(
"year"
,
2018
)
)
;
assertEquals
(
map
(
)
.
put
(
"map"
,
new
ImmutableMapImpl
(
)
.
putValue
(
"year"
,
2018
)
)
,
val
.
asMap
(
)
)
;
val
=
namedParam
.
addValueAs
(
empty
,
map
(
)
.
put
(
"year"
,
2018
)
.
put
(
"age"
,
1111
)
)
;
assertEquals
(
map
(
)
.
put
(
"map"
,
new
ImmutableMapImpl
(
)
.
putValue
(
"year"
,
2018
)
.
putValue
(
"age"
,
1111
)
)
,
val
.
asMap
(
)
)
;
assertSame
(
val
,
namedParam
.
addValueAs
(
val
,
null
)
)
;
assertSame
(
val
,
namedParam
.
addValueAs
(
val
,
entry
(
"year"
,
2018
)
)
)
;
assertNull
(
namedParam
.
addValueAs
(
val
,
entry
(
"year"
,
1111
)
)
)
;
}
;
checker
.
accept
(
new
MapParameterInfo
(
"map"
)
.
setContainerKind
(
ContainerKind
.
MAP
)
,
new
ImmutableMapImpl
(
)
)
;
checker
.
accept
(
new
MapParameterInfo
(
"map"
)
.
setContainerKind
(
ContainerKind
.
MAP
)
,
new
ImmutableMapImpl
(
)
.
putValue
(
"map"
,
null
)
)
;
checker
.
accept
(
new
MapParameterInfo
(
"map"
)
.
setContainerKind
(
ContainerKind
.
MAP
)
,
new
ImmutableMapImpl
(
)
.
putValue
(
"map"
,
Collections
.
emptyMap
(
)
)
)
;
checker
.
accept
(
new
MapParameterInfo
(
"map"
)
,
new
ImmutableMapImpl
(
)
.
putValue
(
"map"
,
Collections
.
emptyMap
(
)
)
)
;
checker
.
accept
(
new
MapParameterInfo
(
"map"
)
,
new
ImmutableMapImpl
(
)
.
putValue
(
"map"
,
new
ImmutableMapImpl
(
)
)
)
;
checker
.
accept
(
new
MapParameterInfo
(
"map"
)
,
null
)
;
}
