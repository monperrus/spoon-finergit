/** 
 * Transaction for use when removing partitions during cleanup
 */
public
CleanupTransaction
newCleanupTransaction
(
DecoratedKey
key
,
PartitionColumns
partitionColumns
,
int
nowInSec
)
{
if
(
!
hasIndexes
(
)
)
return
CleanupTransaction
.
NO_OP
;
Index
[
]
interestedIndexes
=
indexes
.
values
(
)
.
stream
(
)
.
filter
(
i
->
i
.
indexes
(
partitionColumns
)
)
.
toArray
(
Index
[
]
::
new
)
;
return
interestedIndexes
.
length
==
0
?
CleanupTransaction
.
NO_OP
:
new
CleanupGCTransaction
(
key
,
nowInSec
,
interestedIndexes
)
;
}
