/** 
 * Transaction for updates on the write path.
 */
public
UpdateTransaction
newUpdateTransaction
(
PartitionUpdate
update
,
OpOrder
.
Group
opGroup
,
int
nowInSec
)
{
if
(
!
hasIndexes
(
)
)
return
UpdateTransaction
.
NO_OP
;
Index
.
Indexer
[
]
indexers
=
indexes
.
values
(
)
.
stream
(
)
.
filter
(
i
->
i
.
indexes
(
update
.
columns
(
)
)
)
.
map
(
i
->
i
.
indexerFor
(
update
.
partitionKey
(
)
,
nowInSec
,
opGroup
,
IndexTransaction
.
Type
.
UPDATE
)
)
.
toArray
(
Index
.
Indexer
[
]
::
new
)
;
return
indexers
.
length
==
0
?
UpdateTransaction
.
NO_OP
:
new
WriteTimeTransaction
(
indexers
)
;
}
