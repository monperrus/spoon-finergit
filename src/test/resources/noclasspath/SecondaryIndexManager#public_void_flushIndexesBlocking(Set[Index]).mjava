/** 
 * Perform a blocking flush of selected indexes
 */
public
void
flushIndexesBlocking
(
Set
<
Index
>
indexes
)
{
if
(
indexes
.
isEmpty
(
)
)
return
;
List
<
Future
<
?
>
>
wait
=
new
ArrayList
<
>
(
)
;
List
<
Index
>
nonCfsIndexes
=
new
ArrayList
<
>
(
)
;
synchronized
(
baseCfs
.
getTracker
(
)
)
{
indexes
.
forEach
(
index
->
index
.
getBackingTable
(
)
.
map
(
cfs
->
wait
.
add
(
cfs
.
forceFlush
(
)
)
)
.
orElseGet
(
(
)
->
nonCfsIndexes
.
add
(
index
)
)
)
;
}
executeAllBlocking
(
nonCfsIndexes
.
stream
(
)
,
Index
::
getBlockingFlushTask
)
;
FBUtilities
.
waitOnFutures
(
wait
)
;
}
