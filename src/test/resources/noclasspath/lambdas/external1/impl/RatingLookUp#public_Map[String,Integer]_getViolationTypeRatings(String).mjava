@Override
@Transactional
public
Map
<
String
,
Integer
>
getViolationTypeRatings
(
String
userId
)
{
Map
<
String
,
Integer
>
map
=
new
HashMap
<
>
(
)
;
entityManager
.
createQuery
(
forTypes
,
RatingEntry
.
class
)
.
setParameter
(
"userId"
,
userId
)
.
getResultList
(
)
.
forEach
(
entry
->
map
.
put
(
entry
.
getViolationType
(
)
,
entry
.
getRating
(
)
)
)
;
Arrays
.
stream
(
ViolationType
.
values
(
)
)
.
map
(
type
->
type
.
toString
(
)
)
.
filter
(
type
->
!
map
.
containsKey
(
type
)
)
.
forEach
(
type
->
map
.
put
(
type
,
DEFAULT_RATING
)
)
;
return
map
;
}
