public
HunspellService
(
final
Settings
settings
,
final
Environment
env
,
final
Map
<
String
,
Dictionary
>
knownDictionaries
)
throws
IOException
{
super
(
settings
)
;
this
.
knownDictionaries
=
Collections
.
unmodifiableMap
(
knownDictionaries
)
;
this
.
hunspellDir
=
resolveHunspellDirectory
(
env
)
;
this
.
defaultIgnoreCase
=
HUNSPELL_IGNORE_CASE
.
get
(
settings
)
;
this
.
loadingFunction
=
(
locale
)
->
{
try
{
return
loadDictionary
(
locale
,
settings
,
env
)
;
}
catch
(
Exception
e
)
{
throw
new
IllegalStateException
(
"failed to load hunspell dictionary for locale: "
+
locale
,
e
)
;
}
}
;
if
(
!
HUNSPELL_LAZY_LOAD
.
get
(
settings
)
)
{
scanAndLoadDictionaries
(
)
;
}
}
